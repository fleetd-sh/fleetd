name: k3s
version: 1.0.0
description: Lightweight Kubernetes (k3s) cluster support for Raspberry Pi and edge devices
author: fleetd
platforms:
- linux
architectures:
- amd64
- arm64
- arm
options:
  role:
    type: enum
    description: K3s node role
    values:
    - server
    - agent
    required: true
  server:
    type: string
    description: K3s server URL (required for agent nodes)
    required_if: role=agent
    example: https://192.168.1.10:6443
  token:
    type: string
    description: K3s cluster token (required for agent nodes)
    required_if: role=agent
    sensitive: true
  version:
    type: string
    description: K3s version to install
files:
- source: install.sh
  destination: /boot/firmware/plugins/k3s-install.sh
  permissions: '0755'
  template: false
- source: k3s.env.tmpl
  destination: /boot/firmware/plugins/k3s.env
  permissions: '0644'
  template: true
hooks:
  firstrun:
    enabled: true
    script: /boot/firmware/plugins/k3s-install.sh
    order: 100
resources:
  min_memory_mb: 512
  min_disk_mb: 2048
  requires_network: true
